[{"filename": "python/triton/common/build.py", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "file_content_changes": "@@ -18,8 +18,17 @@ def is_hip():\n \n @functools.lru_cache()\n def libcuda_dirs():\n-    locs = subprocess.check_output([\"whereis\", \"libcuda.so\"]).decode().strip().split()[1:]\n-    return [os.path.dirname(loc) for loc in locs]\n+    libs = subprocess.check_output([\"ldconfig\", \"-p\"]).decode()\n+    # each line looks like the following:\n+    # libcuda.so.1 (libc6,x86-64) => /lib/x86_64-linux-gnu/libcuda.so.1\n+    locs = [line.split()[-1] for line in libs.splitlines() if \"libcuda.so\" in line]\n+    dirs = [os.path.dirname(loc) for loc in locs]\n+    msg = 'libcuda.so cannot found!\\n'\n+    if locs:\n+        msg += 'Possible files are located at %s.' % str(locs)\n+        msg += 'Please create a symlink of libcuda.so to any of the file.'\n+    assert any(os.path.exists(os.path.join(path, 'libcuda.so')) for path in dirs), msg\n+    return dirs\n \n \n @functools.lru_cache()"}]