[{"filename": "python/triton/testing.py", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "file_content_changes": "@@ -106,10 +106,8 @@ def allclose(x, y, atol=0, rtol=1e-2):\n         return torch.sum(x ^ y) == 0\n     if x.dtype in [torch.int8, torch.int16, torch.int32, torch.int64]:\n         rtol = 0\n-    diff = abs(x - y)\n-    x_max = torch.max(x)\n-    y_max = torch.max(y)\n-    return torch.max(diff) <= atol + rtol * torch.max(x_max, y_max)\n+        atol = 0\n+    return torch.allclose(x, y, rtol=rtol, atol=atol)\n \n \n def nvsmi(attrs):"}]