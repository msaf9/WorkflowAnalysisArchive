[{"filename": "lib/Conversion/TritonGPUToLLVM/TritonGPUToLLVM.cpp", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "file_content_changes": "@@ -2927,7 +2927,7 @@ struct DotOpMmaV1ConversionHelper {\n   // Loading $c to registers, returns a LLVM::Struct.\n   Value loadC(Value C, Value llC, ConversionPatternRewriter &rewriter) const;\n \n-  static ArrayRef<unsigned> getOrder() { return order; }\n+  static ArrayRef<unsigned> getOrder() { return mmaOrder; }\n \n   // Compute the offset of the matrix to load.\n   // Returns offsetAM, offsetAK, offsetBN, offsetBK.\n@@ -2947,7 +2947,7 @@ struct DotOpMmaV1ConversionHelper {\n \n private:\n   static constexpr unsigned instrShape[] = {16, 16, 4};\n-  static constexpr unsigned order[] = {0, 1};\n+  static constexpr unsigned mmaOrder[] = {0, 1};\n };\n \n // Helper for conversion of DotOp with mma<version=2>, that is sm>=80\n@@ -3874,7 +3874,7 @@ Value DotOpMmaV1ConversionHelper::loadA(\n     int stepAK = isARow ? k / (numPtrA * vecA) * (numPtrA * vecA) : k;\n     Value pa = gep(f16PtrTy, thePtrA,\n                    i32_val(stepAM * strideRepM * strideAM + stepAK * strideAK));\n-    Type aPtrTy = ptr_ty(vec_ty(i32_ty, vecA / 2), 3);\n+    Type aPtrTy = ptr_ty(vec_ty(i32_ty, std::max<int>(vecA / 2, 1)), 3);\n     Value ha = load(bitcast(pa, aPtrTy));\n     // record lds that needs to be moved\n     Value ha00 = bitcast(extract_element(ha, i32_val(0)), f16x2Ty);\n@@ -3976,7 +3976,8 @@ Value DotOpMmaV1ConversionHelper::loadB(\n     int stepBK = isBRow ? K : K / (numPtrB * vecB) * (numPtrB * vecB);\n     Value pb = gep(f16PtrTy, thePtrB,\n                    i32_val(stepBN * strideRepN * strideBN + stepBK * strideBK));\n-    Value hb = load(bitcast(pb, ptr_ty(vec_ty(i32_ty, vecB / 2), 3)));\n+    Value hb =\n+        load(bitcast(pb, ptr_ty(vec_ty(i32_ty, std::max(vecB / 2, 1)), 3)));\n     // record lds that needs to be moved\n     Value hb00 = bitcast(extract_element(hb, i32_val(0)), f16x2Ty);\n     Value hb01 = bitcast(extract_element(hb, i32_val(1)), f16x2Ty);"}]