[{"filename": "python/triton/runtime/jit.py", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "file_content_changes": "@@ -286,8 +286,10 @@ def {self.fn.__name__}({', '.join(self.arg_names)}, grid, num_warps=4, num_stage\n     grid_0 = grid[0]\n     grid_1 = grid[1] if grid_size > 1 else 1\n     grid_2 = grid[2] if grid_size > 2 else 1\n+    device = torch.cuda.current_device()\n+    torch.cuda.set_device(device)\n     if stream is None:\n-      stream = get_cuda_stream(None)\n+      stream = get_cuda_stream(device)\n     try:\n       bin = cache[key]\n       bin.c_wrapper(grid_0, grid_1, grid_2, stream, {args})"}]