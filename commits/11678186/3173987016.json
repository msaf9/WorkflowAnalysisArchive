[{"filename": "python/triton/compiler.py", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "file_content_changes": "@@ -1102,9 +1102,9 @@ def put(self, data, filename, binary=True):\n \n \n @functools.lru_cache()\n-def libcuda_dir():\n-    loc = subprocess.check_output([\"whereis\", \"libcuda.so\"]).decode().strip().split()[-1]\n-    return os.path.dirname(loc)\n+def libcuda_dirs():\n+    locs = subprocess.check_output([\"whereis\", \"libcuda.so\"]).decode().strip().split()[1:]\n+    return [ os.path.dirname(loc) for loc in locs ]\n \n \n @contextlib.contextmanager\n@@ -1118,7 +1118,7 @@ def quiet():\n \n \n def _build(name, src, srcdir):\n-    cuda_lib_dir = libcuda_dir()\n+    cuda_lib_dirs = libcuda_dirs()\n     cu_include_dir = \"/usr/local/cuda/include\"\n     suffix = sysconfig.get_config_var('EXT_SUFFIX')\n     so = os.path.join(srcdir, '{name}{suffix}'.format(name=name, suffix=suffix))\n@@ -1130,7 +1130,9 @@ def _build(name, src, srcdir):\n         gcc = shutil.which(\"gcc\")\n         cc = gcc if gcc is not None else clang\n     py_include_dir = get_paths()[\"include\"]\n-    ret = subprocess.check_call([cc, src, \"-O3\", f\"-I{cu_include_dir}\", f\"-I{py_include_dir}\", f\"-I{srcdir}\", \"-shared\", \"-fPIC\", f\"-L{cuda_lib_dir}\", \"-lcuda\", \"-o\", so])\n+    cc_cmd = [cc, src, \"-O3\", f\"-I{cu_include_dir}\", f\"-I{py_include_dir}\", f\"-I{srcdir}\", \"-shared\", \"-fPIC\", \"-lcuda\", \"-o\", so]\n+    cc_cmd += [ f\"-L{dir}\" for dir in cuda_lib_dirs ]\n+    ret = subprocess.check_call(cc_cmd)\n     if ret == 0:\n         return so\n     # fallback on setuptools"}]