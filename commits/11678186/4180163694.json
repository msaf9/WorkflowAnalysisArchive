[{"filename": "lib/Dialect/TritonGPU/Transforms/Combine.cpp", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "file_content_changes": "@@ -602,6 +602,7 @@ class FoldConvertAndReduce : public mlir::RewritePattern {\n       }\n       // don't rematerialize non-element-wise\n       if (!isa<triton::ViewOp, triton::CatOp>(op) &&\n+          !op->hasTrait<mlir::OpTrait::SameOperandsAndResultEncoding>() &&\n           !op->hasTrait<mlir::OpTrait::Elementwise>() &&\n           !isa<triton::StoreOp>(op)) {\n         return failure();\n@@ -866,6 +867,7 @@ class RematerializeForward : public mlir::RewritePattern {\n \n     for (Operation *op : cvtSlices) {\n       if (!isa<triton::ViewOp, triton::CatOp>(op) &&\n+          !op->hasTrait<mlir::OpTrait::SameOperandsAndResultEncoding>() &&\n           !op->hasTrait<mlir::OpTrait::Elementwise>() &&\n           !isa<triton::StoreOp>(op))\n         return failure();"}]