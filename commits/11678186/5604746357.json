[{"filename": "lib/Conversion/TritonGPUToLLVM/ConvertLayoutOpToLLVM/SharedToDotOperandMMAv2.cpp", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "file_content_changes": "@@ -500,6 +500,14 @@ std::function<void(int, int)> getLoadMatrixFn(\n   const int elemBytes = tensorTy.getElementTypeBitWidth() / 8;\n   auto order = sharedLayout.getOrder();\n \n+  if (tensor.getType()\n+          .cast<RankedTensorType>()\n+          .getElementType()\n+          .isa<mlir::Float8E4M3B11FNUZType>()) {\n+    bool noTrans = (isA ^ order[0] == 0);\n+    assert(noTrans && \"float8e4b15 must have row-col layout\");\n+  }\n+\n   if (kWidth != (4 / elemBytes))\n     assert(vecPhase == 1 || vecPhase == 4 * kWidth);\n "}, {"filename": "python/test/unit/operators/test_matmul.py", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "file_content_changes": "@@ -89,13 +89,21 @@ def kernel(Y, X, N, BLOCK_SIZE: tl.constexpr):\n                 (128, 256, 32, 1, 8, 2, None, None, None, AT, BT, ADTYPE, BDTYPE),\n                 (32, 64, 32, 1, 1, 2, 64, 128, 32, AT, BT, ADTYPE, BDTYPE),\n                 (128, 128, 32, 8, 4, 2, 256, 256, 128, AT, BT, ADTYPE, BDTYPE),\n-            ] for ADTYPE, BDTYPE in [(\"float8e4b15\", \"float8e5\"),\n+            ] for ADTYPE, BDTYPE in [(\"float8e4\", \"float8e5\"),\n                                      (\"float8e4\", \"float16\"),\n                                      (\"float16\", \"float8e5\"),\n                                      (\"float16\", \"float32\"),\n                                      (\"float32\", \"float16\"),\n                                      (\"bfloat16\", \"float32\"),\n                                      (\"float32\", \"bfloat16\")] for AT in [False, True] for BT in [False, True]\n+        ],\n+        *[\n+            # float8e4b15 only supports row-col layout\n+            [\n+                (128, 128, 32, 1, 4, 2, None, None, None, False, True, ADTYPE, BDTYPE),\n+            ] for ADTYPE, BDTYPE in [(\"float8e4b15\", \"float8e5\"),\n+                                     (\"float8e4b15\", \"float16\"),\n+                                     (\"float16\", \"float8e4b15\")]\n         ]\n     ),\n )"}]