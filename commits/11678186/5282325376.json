[{"filename": "lib/Conversion/TritonGPUToLLVM/LoadStoreOpToLLVM.cpp", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "file_content_changes": "@@ -352,7 +352,14 @@ struct StoreOpConversion\n           ptxBuilder.newAddrOperand(ptrElems[vecStart], \"l\", in_off);\n \n       auto &ptxStoreInstr =\n-          ptxBuilder.create<>(\"st\")->global().v(nWords).b(width);\n+          ptxBuilder.create<>(\"st\")\n+              ->global()\n+              .o(\"L1::evict_first\",\n+                 op.getEvict() == triton::EvictionPolicy::EVICT_FIRST)\n+              .o(\"L1::evict_last\",\n+                 op.getEvict() == triton::EvictionPolicy::EVICT_LAST)\n+              .v(nWords)\n+              .b(width);\n       ptxStoreInstr(asmAddr, asmArgList).predicate(maskVal, \"b\");\n \n       Type boolTy = getTypeConverter()->convertType(rewriter.getIntegerType(1));"}, {"filename": "test/Conversion/tritongpu_to_llvm.mlir", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "file_content_changes": "@@ -81,6 +81,21 @@ module attributes {\"triton_gpu.num-warps\" = 4 : i32} {\n \n // -----\n \n+#blocked0 = #triton_gpu.blocked<{sizePerThread = [1], threadsPerWarp = [32], warpsPerCTA = [4], order = [0]}>\n+module attributes {\"triton_gpu.num-warps\" = 4 : i32} {\n+  // CHECK-LABEL: store_with_cache_attr\n+  tt.func @store_with_cache_attr(%a_ptr_init : tensor<256x!tt.ptr<f32>, #blocked0>, %cst : tensor<256xi1, #blocked0>, %cst_0 : tensor<256xf32, #blocked0>) {\n+    //      CHECK: llvm.inline_asm\n+    // CHECK-SAME: st.global.L1::evict_last.b32\n+    //      CHECK: llvm.inline_asm\n+    // CHECK-SAME: st.global.L1::evict_last.b32\n+    tt.store %a_ptr_init, %cst_0, %cst {cache = 1 : i32, evict = 3 : i32, isVolatile = false} : tensor<256xf32, #blocked0>\n+    tt.return\n+  }\n+}\n+\n+// -----\n+\n #blocked0 = #triton_gpu.blocked<{sizePerThread = [1], threadsPerWarp = [32], warpsPerCTA = [2], order = [0]}>\n module attributes {\"triton_gpu.num-warps\" = 2 : i32} {\n   // CHECK-LABEL: global_load_store_no_vec"}]