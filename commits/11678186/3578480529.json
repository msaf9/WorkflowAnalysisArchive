[{"filename": "lib/Dialect/TritonGPU/Transforms/Prefetch.cpp", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "file_content_changes": "@@ -130,6 +130,11 @@ LogicalResult Prefetcher::initialize() {\n \n   if (dotsInFor.empty())\n     return failure();\n+  \n+  // TODO: segfault (original for still has uses)\n+  // when used in flash attention that has 2 dots in the loop\n+  if(dotsInFor.size() > 1)\n+    return failure();\n \n   // returns source of cvt\n   auto getPrefetchSrc = [](Value v) -> Value {"}, {"filename": "python/triton/compiler.py", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "file_content_changes": "@@ -884,7 +884,7 @@ def ttir_to_ttgir(mod, num_warps, num_stages, compute_capability):\n     pm.add_tritongpu_pipeline_pass(num_stages)\n     # Prefetch must be done after pipeline pass because pipeline pass\n     # extracts slices from the original tensor.\n-    # pm.add_tritongpu_prefetch_pass()\n+    pm.add_tritongpu_prefetch_pass()\n     pm.add_canonicalizer_pass()\n     pm.add_cse_pass()\n     pm.add_triton_gpu_combine_pass(compute_capability)"}]