[{"filename": "lib/Dialect/TritonGPU/Transforms/RemoveLayoutConversions.cpp", "status": "modified", "additions": 13, "deletions": 2, "changes": 15, "file_content_changes": "@@ -555,8 +555,19 @@ class ConvertDotConvert : public mlir::RewritePattern {\n       return mlir::failure();\n \n     // TODO: int tensor cores\n-    auto _0f = rewriter.create<arith::ConstantFloatOp>(\n-        op->getLoc(), APFloat(0.0f), dstTy.getElementType().cast<FloatType>());\n+    auto out_dtype = dstTy.getElementType().cast<FloatType>();\n+    APFloat value(0.0f);\n+    if (out_dtype.isBF16())\n+      value = APFloat(APFloat::IEEEhalf(), APInt(16, 0));\n+    else if (out_dtype.isF16())\n+      value = APFloat(APFloat::IEEEhalf(), APInt(16, 0));\n+    else if (out_dtype.isF32())\n+      value = APFloat(0.0f);\n+    else\n+      llvm_unreachable(\"unsupported data type\");\n+\n+    auto _0f =\n+        rewriter.create<arith::ConstantFloatOp>(op->getLoc(), value, out_dtype);\n     auto _0 = rewriter.create<triton::SplatOp>(\n         op->getLoc(), dotOp.getResult().getType(), _0f);\n     auto newDot = rewriter.create<triton::DotOp>("}]