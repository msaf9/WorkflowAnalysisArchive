[{"filename": "lib/Dialect/TritonGPU/IR/Dialect.cpp", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "file_content_changes": "@@ -359,7 +359,12 @@ bool expensiveCat(triton::CatOp cat, Attribute &targetEncoding) {\n   // convert encoding that goes through shared memory anyway. So we consider it\n   // as expensive.\n   auto tensorTy = cat.getResult().getType().cast<RankedTensorType>();\n-  auto totalElemsPerThread = triton::gpu::getTotalElemsPerThread(tensorTy);\n+  auto lhsTy = cat.getLhs().getType().cast<RankedTensorType>();\n+  auto rhsTy = cat.getRhs().getType().cast<RankedTensorType>();\n+  auto lhsTotalElemsPerThread = triton::gpu::getTotalElemsPerThread(lhsTy);\n+  auto rhsTotalElemsPerThread = triton::gpu::getTotalElemsPerThread(rhsTy);\n+  auto totalElemsPerThread =\n+      nextPowOf2(lhsTotalElemsPerThread + rhsTotalElemsPerThread);\n   auto shape = tensorTy.getShape();\n   auto elemTy = tensorTy.getElementType();\n   auto newTotalElemsPerThread ="}]