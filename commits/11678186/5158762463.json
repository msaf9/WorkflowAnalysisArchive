[{"filename": "lib/Conversion/TritonGPUToLLVM/ConvertLayoutOpToLLVM/SharedToDotOperandMMAv2.cpp", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "file_content_changes": "@@ -142,8 +142,11 @@ MMA16816SmemLoader::computeLdmatrixMatOffs(Value warpId, Value lane,\n   //          ~~~~~~~ out-of-bound access\n   Value sOff = urem(add(sOffInMat, mul(sMatOff, i32_val(sMatShape))),\n                     i32_val(tileShape[order[1]]));\n+  auto totalNumMats = tileShape[order[0]] / matShape[order[0]];\n+  Value maxMatOffIndex = add(cSwizzleMatOff, i32_val(totalNumMats));\n   for (int i = 0; i < numPtrs; ++i) {\n     Value cMatOffI = add(cMatOff, i32_val(i * pLoadStrideInMat));\n+    cMatOffI = urem(cMatOffI, maxMatOffIndex);\n     cMatOffI = xor_(cMatOffI, phase);\n     offs[i] = add(mul(cMatOffI, i32_val(cMatShape)), mul(sOff, sStride));\n   }"}]