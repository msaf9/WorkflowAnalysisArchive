[{"filename": ".github/workflows/integration-tests.yml", "status": "modified", "additions": 5, "deletions": 22, "changes": 27, "file_content_changes": "@@ -150,35 +150,18 @@ jobs:\n \n       - name: Get last merged PR workflow run ID\n         env:\n+          ARTIFACT_NAME: artifacts\n           ARTIFACT_JOB_NAME: Integration-Tests\n           GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n         run: |\n           OWNER_REPO=\"${{ github.repository }}\"\n-          PULLS=$(gh api repos/$OWNER_REPO/pulls --per-page 100 --state closed)\n-          PULLS_COUNT=$(echo \"$PULLS\" | jq length)\n-          echo \"PULLS_COUNT: $PULLS_COUNT\"\n-          MERGED_PULLS=$(echo \"$PULLS\" | jq \".[] | select(.merged_at != null) | .number\")\n-          MERGED_PULLS_COUNT=$(echo \"$MERGED_PULLS\" | jq length)\n-          echo \"MERGED_PULLS_COUNT: $MERGED_PULLS_COUNT\"\n-          PR_NUMBER=$(echo \"$PULLS\" | jq \".[] | select(.merged_at != null) | .number\" | head -1)\n+          PR_NUMBER=$(gh api --method GET repos/$OWNER_REPO/pulls -f state=closed | jq \".[] | select(.merged_at != null) | .number\" | head -1)\n           echo \"Last merged PR number: $PR_NUMBER\"\n \n-          WORKFLOW_RUN_ID=$(gh api repos/$OWNER_REPO/pulls/$PR_NUMBER/check-runs \\\n-            --jq \".check_runs[] | select(.name == \\\"$ARTIFACT_JOB_NAME\\\") | .check_suite_id\" \\\n-            --header \"Accept: application/vnd.github+json\")\n-          echo \"Workflow run ID: $WORKFLOW_RUN_ID\"\n-          echo \"WORKFLOW_RUN_ID=$WORKFLOW_RUN_ID\" >> $GITHUB_ENV\n-\n-      - name: Download artifact\n-        env:\n-          ARTIFACT_NAME: artifacts\n-          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n-          ARTIFACT_JOB_NAME: Integration-Tests\n-        run: |\n-          OWNER_REPO=\"${{ github.repository }}\"\n-          ARTIFACT_URL=$(gh api repos/$OWNER_REPO/actions/runs/$WORKFLOW_RUN_ID/artifacts \\\n-            --jq \".artifacts[] | select(.name == \\\"$ARTIFACT_NAME\\\") | .archive_download_url\")\n+          GIT_HASH=$(gh api repos/$OWNER_REPO/pulls/$PR_NUMBER/commits | jq '.[0].sha' --raw-output)\n+          WORKFLOW_RUN_ID=$(gh api --method GET repos/$OWNER_REPO/actions/runs -f commit=$GIT_HASH | jq '.workflow_runs[0].id' --raw-output)\n+          ARTIFACT_URL=$(gh api repos/$OWNER_REPO/actions/runs/$WORKFLOW_RUN_ID/artifacts | jq '.artifacts[].archive_download_url' --raw-output)\n \n           if [ -n \"$ARTIFACT_URL\" ]; then\n             echo \"Downloading artifact: $ARTIFACT_URL\""}]