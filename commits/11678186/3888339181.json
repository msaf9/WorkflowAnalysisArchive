[{"filename": "python/triton/ops/blocksparse/softmax.py", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "file_content_changes": "@@ -117,6 +117,7 @@ def _blocksparse_softmax_bwd(\n     # compute\n     da = a * (dout - tl.sum(a * dout, 0))\n     da = tl.where((ns > m) & is_causal, 0., da)\n+    da = tl.where(a != a, float(\"nan\"), da)\n     # apply relative attention\n     if DR is not None:\n         DR += z * stride_zr"}]