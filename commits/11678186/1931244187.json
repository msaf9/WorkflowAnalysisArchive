[{"filename": "lib/codegen/analysis/layout.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "file_content_changes": "@@ -213,7 +213,7 @@ mma_layout::mma_layout(size_t num_warps,\n   else{\n     // fpw_ = {1, 1, 1};\n     spw_ = mma_instr_shape_.at(tensor_core_type_); // e.g., {16, 8, 16} for f32.f16.f16.f32\n-    contig_per_thread_ = {1, 2};\n+    contig_per_thread_ = {1, 1};\n     // rep_ = {2,  2, 1};\n   }\n   order_ = {0, 1};"}, {"filename": "lib/codegen/selection/generator.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "file_content_changes": "@@ -2377,8 +2377,8 @@ void generator::visit_layout_convert(ir::value *out, ir::value *in){\n   }\n   in_ord = in_layout->to_mma() ? out_ord : in_ord;\n   out_ord = out_layout->to_mma() ? in_ord : out_ord;\n-  int in_vec = in_layout->contig_per_thread(in_ord[0]);\n-  int out_vec = out_layout->contig_per_thread(out_ord[0]);\n+  int in_vec = out_ord[0] == 0 ? 1 : in_layout->contig_per_thread(in_ord[0]);\n+  int out_vec = out_ord[0] == 0 ? 1 : out_layout->contig_per_thread(out_ord[0]);\n   int pad = std::max(in_vec, out_vec);\n   Value *in_ld = i32(shape[in_ord[0]] + pad);\n   Value *out_ld = i32(shape[out_ord[0]] + pad);"}]