[{"filename": "lib/Conversion/TritonGPUToLLVM/TritonGPUToLLVM.cpp", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "file_content_changes": "@@ -3557,6 +3557,7 @@ struct MMA16816ConversionHelper {\n     auto aTensorTy = a.getType().cast<RankedTensorType>();\n     auto dTensorTy = d.getType().cast<RankedTensorType>();\n \n+\n     auto aShape = aTensorTy.getShape();\n     auto dShape = dTensorTy.getShape();\n \n@@ -3609,14 +3610,17 @@ struct MMA16816ConversionHelper {\n         for (int n = 0; n < numRepN; ++n)\n           callMma(2 * m, n, 2 * k);\n \n+    Type resElemTy = dTensorTy.getElementType();\n+\n+\n     // bitcast to fp32 in bulk\n     for (auto &elem : fc) {\n-      elem = bitcast(elem, type::i32Ty(ctx));\n+      elem = bitcast(elem, resElemTy);\n     }\n \n     // replace with new packed result\n     Type structTy = LLVM::LLVMStructType::getLiteral(\n-        ctx, SmallVector<Type>(fc.size(), type::i32Ty(ctx)));\n+        ctx, SmallVector<Type>(fc.size(), resElemTy));\n     Value res = getStructFromElements(loc, fc, rewriter, structTy);\n     rewriter.replaceOp(op, res);\n "}]